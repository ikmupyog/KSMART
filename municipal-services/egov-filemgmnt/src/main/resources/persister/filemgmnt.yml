serviceMaps:
  serviceName: egov-filemgmnt
  mappings:
  # insert applicant personal, address, document and applicant child (other details)
  - version: 1.0
    description: Persists applicant details in egov_filemgmnt database, eg_fm_applicantpersonal table
    fromTopic: save-fm-applicantpersonal
    isTransaction: true
    queryMaps:
    - query: >
        INSERT INTO eg_fm_applicantpersonal(id, aadhaarno, email, firstname, firstnamemal, lastname, lastnamemal, title, mobileno, tenantid, fatherfirstname, fatherfirstnamemal, fatherlastname, fatherlastnamemal, motherfirstname, motherfirstnamemal, motherlastname, motherlastnamemal, applicantcategory, dateofbirth, bankaccountno, createdby, createdtime, lastmodifiedby, lastmodifiedtime) 
        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
      basePath: ApplicantServiceDetail
      jsonMaps:
      - jsonPath: $.ApplicantServiceDetail.applicant.id

      - jsonPath: $.ApplicantServiceDetail.applicant.aadhaarNo 
      
      - jsonPath: $.ApplicantServiceDetail.applicant.email 
      
      - jsonPath: $.ApplicantServiceDetail.applicant.firstName 
      
      - jsonPath: $.ApplicantServiceDetail.applicant.firstNameMal 
      
      - jsonPath: $.ApplicantServiceDetail.applicant.lastName
      
      - jsonPath: $.ApplicantServiceDetail.applicant.lastNameMal 
      
      - jsonPath: $.ApplicantServiceDetail.applicant.title 
      
      - jsonPath: $.ApplicantServiceDetail.applicant.mobileNo 
      
      - jsonPath: $.ApplicantServiceDetail.applicant.tenantId
      
      - jsonPath: $.ApplicantServiceDetail.applicant.fatherFirstName
      
      - jsonPath: $.ApplicantServiceDetail.applicant.fatherFirstNameMal
      
      - jsonPath: $.ApplicantServiceDetail.applicant.fatherLastName
      
      - jsonPath: $.ApplicantServiceDetail.applicant.fatherLastNameMal
      
      - jsonPath: $.ApplicantServiceDetail.applicant.motherFirstName
      
      - jsonPath: $.ApplicantServiceDetail.applicant.motherFirstNameMal
      
      - jsonPath: $.ApplicantServiceDetail.applicant.motherLastName
      
      - jsonPath: $.ApplicantServiceDetail.applicant.motherLastNameMal
      
      - jsonPath: $.ApplicantServiceDetail.applicant.applicantCategory
      
      - jsonPath: $.ApplicantServiceDetail.applicant.dateOfBirth
      
      - jsonPath: $.ApplicantServiceDetail.applicant.bankAccountNo
      
      - jsonPath: $.ApplicantServiceDetail.applicant.auditDetails.createdBy

      - jsonPath: $.ApplicantServiceDetail.applicant.auditDetails.createdTime
      
      - jsonPath: $.ApplicantServiceDetail.applicant.auditDetails.lastModifiedBy

      - jsonPath: $.ApplicantServiceDetail.applicant.auditDetails.lastModifiedTime
 
    - query: >
        INSERT INTO eg_fm_applicantaddress(id, buildingno, subno, housename, housenamemal, village, taluk, street, streetmal, pincode, postofficename, residenceassociationno, localplace, localplacemal, mainplace, mainplacemal, wardno, createdby, createddate, lastmodifiedby, lastmodifieddate,applicantpersonalid)
        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
      basePath: ApplicantServiceDetail.applicant
      jsonMaps:    
      - jsonPath: $.ApplicantServiceDetail.applicant.address.id

      - jsonPath: $.ApplicantServiceDetail.applicant.address.buildingNo
      
      - jsonPath: $.ApplicantServiceDetail.applicant.address.subNo
     
      - jsonPath: $.ApplicantServiceDetail.applicant.address.houseName
      
      - jsonPath: $.ApplicantServiceDetail.applicant.address.houseNameMal
      
      - jsonPath: $.ApplicantServiceDetail.applicant.address.village
      
      - jsonPath: $.ApplicantServiceDetail.applicant.address.taluk
     
      - jsonPath: $.ApplicantServiceDetail.applicant.address.street
      
      - jsonPath: $.ApplicantServiceDetail.applicant.address.streetmal
     
      - jsonPath: $.ApplicantServiceDetail.applicant.address.pincode
     
      - jsonPath: $.ApplicantServiceDetail.applicant.address.postOfficeName
      
      - jsonPath: $.ApplicantServiceDetail.applicant.address.residenceAssociationNo
      
      - jsonPath: $.ApplicantServiceDetail.applicant.address.localPlace
      
      - jsonPath: $.ApplicantServiceDetail.applicant.address.localPlaceMal
      
      - jsonPath: $.ApplicantServiceDetail.applicant.address.mainPlace
      
      - jsonPath: $.ApplicantServiceDetail.applicant.address.mainPlaceMal
      
      - jsonPath: $.ApplicantServiceDetail.applicant.address.wardNo
     
      - jsonPath: $.ApplicantServiceDetail.applicant.address.auditDetails.createdBy

      - jsonPath: $.ApplicantServiceDetail.applicant.address.auditDetails.createdTime
     
      - jsonPath: $.ApplicantServiceDetail.applicant.address.auditDetails.lastModifiedBy

      - jsonPath: $.ApplicantServiceDetail.applicant.address.auditDetails.lastModifiedTime  
 
      - jsonPath: $.ApplicantServiceDetail.applicant.address.applicantPersonalId
 
    - query: >
        INSERT INTO eg_fm_applicantdocument(id, applicantpersonalid, documenttypeid, documentnumber, docexpirydate, createdby, createddate, lastmodifiedby, lastmodifieddate )
        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?  )        
      basePath: ApplicantServiceDetail.applicant
      jsonMaps:    
      - jsonPath: $.ApplicantServiceDetail.applicant.document.id         
      
      - jsonPath: $.ApplicantServiceDetail.applicant.document.applicantPersonalId
      
      - jsonPath: $.ApplicantServiceDetail.applicant.document.documentTypeId

      - jsonPath: $.ApplicantServiceDetail.applicant.document.documentNumber
     
      - jsonPath: $.ApplicantServiceDetail.applicant.document.docExpiryDate              
       
      - jsonPath: $.ApplicantServiceDetail.applicant.document.auditDetails.createdBy

      - jsonPath: $.ApplicantServiceDetail.applicant.document.auditDetails.createdTime
     
      - jsonPath: $.ApplicantServiceDetail.applicant.document.auditDetails.lastModifiedBy

      - jsonPath: $.ApplicantServiceDetail.applicant.document.auditDetails.lastModifiedTime

    - query: >
        INSERT INTO eg_fm_applicantpersonal_child(id, applicantpersonalid, buildingnumber, relationofassessee, nameofoccupier,  relationofoccupier, durationofresidenceinyears, ownername, ownernamemal, owneraddress, owneraddressmal, ownermobileno, nameofoccupiermal, durationofresidenceinmonths, createdby, createddate, lastmodifiedby, lastmodifieddate) 
        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ? ,?, ?)
      basePath: ApplicantServiceDetail.applicantDetails
      jsonMaps:
      - jsonPath: $.ApplicantServiceDetail.applicantDetails.id

      - jsonPath: $.ApplicantServiceDetail.applicantDetails.applicantPersonalId
      
      - jsonPath: $.ApplicantServiceDetail.applicantDetails.buildingNumber 
      
      - jsonPath: $.ApplicantServiceDetail.applicantDetails.relationOfAssessee   
      
      - jsonPath: $.ApplicantServiceDetail.applicantDetails.nameOfOccupier    
      
      - jsonPath: $.ApplicantServiceDetail.applicantDetails.relationOfOccupier 
    
      - jsonPath: $.ApplicantServiceDetail.applicantDetails.durationOfResidenceInYears  
      
      - jsonPath: $.ApplicantServiceDetail.applicantDetails.ownerName 
      
      - jsonPath: $.ApplicantServiceDetail.applicantDetails.ownerNameMal 
      
      - jsonPath: $.ApplicantServiceDetail.applicantDetails.ownerAddress 
      
      - jsonPath: $.ApplicantServiceDetail.applicantDetails.ownerAddressMal 
      
      - jsonPath: $.ApplicantServiceDetail.applicantDetails.ownerMobileNo 
      
      - jsonPath: $.ApplicantServiceDetail.applicantDetails.nameOfOccupierMal 
      
      - jsonPath: $.ApplicantServiceDetail.applicantDetails.durationOfResidenceInMonths 
      
      - jsonPath: $.ApplicantServiceDetail.applicantDetails.auditDetails.createdBy

      - jsonPath: $.ApplicantServiceDetail.applicantDetails.auditDetails.createdTime
      
      - jsonPath: $.ApplicantServiceDetail.applicantDetails.auditDetails.lastModifiedBy

      - jsonPath: $.ApplicantServiceDetail.applicantDetails.auditDetails.lastModifiedTime
 
  # insert applicant service detail, service document and service file detail
  - version: 1.0
    description: Persists applicant service details in egov_filemgmnt database, eg_fm_servicedetail table
    fromTopic: save-fm-applicantservice
    isTransaction: true
    queryMaps:
    - query: >
        INSERT INTO eg_fm_servicedetail(id, applicantpersonalid, serviceid, servicecode, servicesubtype,  serviceminortype, createdby, createdtime, lastmodifiedby, lastmodifiedtime) 
        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
      basePath: ApplicantServiceDetail
      jsonMaps:
      - jsonPath: $.ApplicantServiceDetail.id

      - jsonPath: $.ApplicantServiceDetail.applicantPersonalId
      
      - jsonPath: $.ApplicantServiceDetail.serviceId 
      
      - jsonPath: $.ApplicantServiceDetail.serviceCode   
      
      - jsonPath: $.ApplicantServiceDetail.servicesubtype    
      
      - jsonPath: $.ApplicantServiceDetail.serviceminortype 
    
      - jsonPath: $.ApplicantServiceDetail.auditDetails.createdBy

      - jsonPath: $.ApplicantServiceDetail.auditDetails.createdTime
      
      - jsonPath: $.ApplicantServiceDetail.auditDetails.lastModifiedBy

      - jsonPath: $.ApplicantServiceDetail.auditDetails.lastModifiedTime

    - query: >
        INSERT INTO eg_fm_applicantservicedocument(id, applicantpersonalid, servicedetailsid, documenttypeid, filestoreid, active, documentnumber, applicationdetails, createdby, createddate, lastmodifiedby, lastmodifieddate)
        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )        
      basePath: ApplicantServiceDetail.serviceDocument
      jsonMaps:    
      - jsonPath: $.ApplicantServiceDetail.serviceDocument.id         
      
      - jsonPath: $.ApplicantServiceDetail.serviceDocument.applicantPersonalId
      
      - jsonPath: $.ApplicantServiceDetail.serviceDocument.serviceDetailsId

      - jsonPath: $.ApplicantServiceDetail.serviceDocument.documentTypeId
     
      - jsonPath: $.ApplicantServiceDetail.serviceDocument.fileStoreId
     
      - jsonPath: $.ApplicantServiceDetail.serviceDocument.active 
      
      - jsonPath: $.ApplicantServiceDetail.serviceDocument.documentNumber 
       
      - jsonPath: $.ApplicantServiceDetail.serviceDocument.applicationDetails              
       
      - jsonPath: $.ApplicantServiceDetail.serviceDocument.auditDetails.createdBy

      - jsonPath: $.ApplicantServiceDetail.serviceDocument.auditDetails.createdTime
     
      - jsonPath: $.ApplicantServiceDetail.serviceDocument.auditDetails.lastModifiedBy

      - jsonPath: $.ApplicantServiceDetail.serviceDocument.auditDetails.lastModifiedTime

    - query: >
        INSERT INTO eg_fm_filedetail(id, tenantid, applicantpersonalid, servicedetailsid, filenumber, filecode, filename, filearisingmode, filearisingdate, financialyear, applicationdate, workflowcode, businessservice, action, filestatus, createdby, createddate, lastmodifiedby, lastmodifieddate)
        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?, ?, ?, ?, ?, ?, ?, ?)        
      basePath: ApplicantServiceDetail.fileDetail
      jsonMaps:    
      - jsonPath: $.ApplicantServiceDetail.fileDetail.id         
      
      - jsonPath: $.ApplicantServiceDetail.fileDetail.tenantId
      
      - jsonPath: $.ApplicantServiceDetail.fileDetail.applicantPersonalId
      
      - jsonPath: $.ApplicantServiceDetail.fileDetail.serviceDetailsId

      - jsonPath: $.ApplicantServiceDetail.fileDetail.fileNumber
     
      - jsonPath: $.ApplicantServiceDetail.fileDetail.fileCode
     
      - jsonPath: $.ApplicantServiceDetail.fileDetail.fileName     
      
      - jsonPath: $.ApplicantServiceDetail.fileDetail.fileArisingMode 
      
      - jsonPath: $.ApplicantServiceDetail.fileDetail.fileArisingDate 
      
      - jsonPath: $.ApplicantServiceDetail.fileDetail.financialYear 
      
      - jsonPath: $.ApplicantServiceDetail.fileDetail.applicationDate 
      
      - jsonPath: $.ApplicantServiceDetail.fileDetail.workflowCode 
      
      - jsonPath: $.ApplicantServiceDetail.fileDetail.businessService 
      
      - jsonPath: $.ApplicantServiceDetail.fileDetail.action 
      
      - jsonPath: $.ApplicantServiceDetail.fileDetail.fileDetail.fileStatus          
       
      - jsonPath: $.ApplicantServiceDetail.fileDetail.auditDetails.createdBy

      - jsonPath: $.ApplicantServiceDetail.fileDetail.auditDetails.createdTime
     
      - jsonPath: $.ApplicantServiceDetail.fileDetail.auditDetails.lastModifiedBy

      - jsonPath: $.ApplicantServiceDetail.fileDetail.auditDetails.lastModifiedTime

  # update applicant, address and document
  - version: 1.0
    description: Update applicant details in egov_filemgmnt database, eg_fm_applicantpersonal table
    fromTopic: update-fm-applicantpersonal
    isTransaction: true
    queryMaps:
    - query: >
         INSERT INTO eg_fm_applicantpersonal_log 
         SELECT * FROM eg_fm_applicantpersonal WHERE id = ?;
      basePath: ApplicantServiceDetail
      jsonMaps:
      - jsonPath: $.ApplicantServiceDetail.applicant.id
                 
    - query: >
        UPDATE eg_fm_applicantpersonal 
        SET aadhaarno = ?, email = ?, firstname = ?, lastname = ?, title = ?, mobileno = ?, lastmodifiedby = ?, lastmodifiedtime = ?
        WHERE id = ?;
        
      basePath: ApplicantServiceDetail
      jsonMaps:
      - jsonPath: $.ApplicantServiceDetail.applicant.aadhaarNo 
      
      - jsonPath: $.ApplicantServiceDetail.applicant.email 
      
      - jsonPath: $.ApplicantServiceDetail.applicant.firstName 
      
      - jsonPath: $.ApplicantServiceDetail.applicant.lastName 
      
      - jsonPath: $.ApplicantServiceDetail.applicant.title 
      
      - jsonPath: $.ApplicantServiceDetail.applicant.mobileNo
     
      - jsonPath: $.ApplicantServiceDetail.applicant.auditDetails.lastModifiedBy

      - jsonPath: $.ApplicantServiceDetail.applicant.auditDetails.lastModifiedTime
        
      - jsonPath: $.ApplicantServiceDetail.applicant.id

    - query: >
         INSERT INTO eg_fm_applicantaddress_log 
         SELECT * FROM eg_fm_applicantaddress WHERE id = ?;
      basePath: ApplicantServiceDetail.applicant
      jsonMaps:
      - jsonPath: $.ApplicantServiceDetail.applicant.address.id       
      
    - query: >      
        UPDATE eg_fm_applicantaddress 
        SET buildingno = ?, housename = ?, street = ?, pincode = ?, postofficename = ?, lastmodifiedby = ?, lastmodifieddate = ?
        WHERE id = ?;
      basePath: ApplicantServiceDetail.applicant
      jsonMaps:
      - jsonPath: $.ApplicantServiceDetail.applicant.address.buildingNo 
      
      - jsonPath: $.ApplicantServiceDetail.applicant.address.houseName  
      
      - jsonPath: $.ApplicantServiceDetail.applicant.address.street 
      
      - jsonPath: $.ApplicantServiceDetail.applicant.address.pincode
      
      - jsonPath: $.ApplicantServiceDetail.applicant.address.postOfficeName          
     
      - jsonPath: $.ApplicantServiceDetail.applicant.address.auditDetails.lastModifiedBy

      - jsonPath: $.ApplicantServiceDetail.applicant.address.auditDetails.lastModifiedTime  
          
      - jsonPath: $.ApplicantServiceDetail.applicant.address.id

    - query: >
         INSERT INTO eg_fm_applicantdocument_log 
         SELECT * FROM eg_fm_applicantdocument WHERE id = ?;
      basePath: ApplicantServiceDetail.applicant
      jsonMaps:
      - jsonPath: $.ApplicantServiceDetail.applicant.document.id   
      
    - query: >      
        UPDATE eg_fm_applicantdocument 
        SET documenttypeid = ?, documentnumber = ?, docexpirydate = ?, lastmodifiedby = ?, lastmodifieddate = ?
        WHERE id = ?;
      basePath: ApplicantServiceDetail.applicant
      jsonMaps:
      - jsonPath: $.ApplicantServiceDetail.applicant.document.documenttypeId 
      
      - jsonPath: $.ApplicantServiceDetail.applicant.document.documentNumber  
      
      - jsonPath: $.ApplicantServiceDetail.applicant.document.docexpiryDate             
     
      - jsonPath: $.ApplicantServiceDetail.applicant.document.auditDetails.lastModifiedBy

      - jsonPath: $.ApplicantServiceDetail.applicant.document.auditDetails.lastModifiedTime
         
      - jsonPath: $.ApplicantServiceDetail.applicant.document.id

  # update applicant service detail, service document, service file detail and applicant chile (other details)
  - version: 1.0
    description: Persists applicant service details in egov_filemgmnt database, eg_fm_servicedetail table
    fromTopic: update-fm-applicantservice
    isTransaction: true
    queryMaps:
    - query: >
         INSERT INTO eg_fm_servicedetail_log 
         SELECT * FROM eg_fm_servicedetail WHERE id = ?;
      basePath: ApplicantServiceDetail
      jsonMaps:
      - jsonPath: $.ApplicantServiceDetail.id  
      
    - query: >      
        UPDATE eg_fm_servicedetail
        SET servicecode = ? ,servicesubtype =?, serviceminortype=?, lastmodifiedby = ?, lastmodifiedtime = ?
        WHERE id = ?;
      basePath: ApplicantServiceDetail
      jsonMaps:
      - jsonPath: $.ApplicantServiceDetail.serviceCode  
      
      - jsonPath: $.ApplicantServiceDetail.servicesubtype 
      
      - jsonPath: $.ApplicantServiceDetail.serviceminortype               
      
      - jsonPath: $.ApplicantServiceDetail.auditDetails.lastModifiedBy

      - jsonPath: $.ApplicantServiceDetail.auditDetails.lastModifiedTime
         
      - jsonPath: $.ApplicantServiceDetail.id

    - query: >
         INSERT INTO eg_fm_applicantservicedocument_log 
         SELECT * FROM eg_fm_applicantservicedocument WHERE id = ?;
      basePath: ApplicantServiceDetail
      jsonMaps:
      - jsonPath: $.ApplicantServiceDetail.serviceDocument.id      
      
    - query: >      
        UPDATE eg_fm_applicantservicedocument
        SET documenttypeid = ?, lastmodifiedby = ?, lastmodifieddate = ?     
        WHERE id = ?;
      basePath: ApplicantServiceDetail
      jsonMaps:
      - jsonPath: $.ApplicantServiceDetail.serviceDocument.documentTypeId             
     
      - jsonPath: $.ApplicantServiceDetail.serviceDocument.auditDetails.lastModifiedBy

      - jsonPath: $.ApplicantServiceDetail.serviceDocument.auditDetails.lastModifiedTime
         
      - jsonPath: $.ApplicantServiceDetail.serviceDocument.id
